<!-- Copyright (c) Microsoft. All rights reserved. Licensed under the MIT license.
See LICENSE in the source repository root for complete license information. -->

{% extends "_Layout.html" %}
{% block Body %}
<br />


<div class="container-fluid">
    <h2 class="text-center">Admin consent required</h2>
    <hr>
    <div class="col-md-12">
        <h4>Your Tenant admin has not given consent to this application. </h4>
        <p>
            This application requires <code>'SecurityEvents.Read.All' and 'SecurityEvents.ReadWrite.All'</code>
            permissions to access the Secuirty API, You currently have <code>{{ session.get('scopes') }}</code>
            permissions.
        </p>
        <hr>
        <p>
            <b>If you are the tenant admin</b>, please give this application consent to access 
            the Security API data in your tenant via the link below.
            For more information on admin consent, read 
            <a href="https://developer.microsoft.com/en-us/graph/docs/concepts/security-authorization#grant-permissions-to-an-application">Granting permissions to an application</a>.
        </p>
        <a href="https://login.microsoftonline.com/common/adminconsent?client_id={{ Config.CLIENT_ID }}&amp;redirect_uri={{ Config.REDIRECT_URI }}">https://login.microsoftonline.com/common/adminconsent?client_id={{ Config.CLIENT_ID }}&amp;redirect_uri={{ Config.REDIRECT_URI }}</a>
        <hr>
        <p>
            <b>If your tenant admin has given consent</b>, Then you are missing the <em>'SecurityEvents.Read.All' or 
            'SecurityEvents.ReadWrite.All'</em> permissions in your app registration. Please go to 
            <a href="https://apps.dev.microsoft.com">https://apps.dev.microsoft.com,</a>to add 
            <em>'SecurityEvents.Read.All' and 'SecurityEvents.ReadWrite.All'</em> to the delegated permissions in your application.
            then have the admin consent to the updated permissions.
        </p>
    </div>
</div>
{% endblock %}